<!doctype html>
<html lang="zh-cn">
  <head>
    <title>Blog_11_23_读者写者问题的三种写法 // The Blog of Yongqiang</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.104.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.0fb49e70a30412f97ddfc418e18fefef1d9fcdebe45f634dbbba768b00fe1eec.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Blog_11_23_读者写者问题的三种写法"/>
<meta name="twitter:description" content="====================================================================== readers are prior [analyse:] writer:
can&rsquo;t write when anyone is reading. exclusive
readers: when one of the readers are reading, the readers who want to read can read.
but them can&rsquo;t read when the writer is writing. exclusive
the action to change the readcount and the lock made the reader and writer exclusive are exclusive.
====================================================================== //the reason why the readcount is not a semaphore is that it was // a condition ,and not a semaphore make the process exclusive int readcount = 0; semaphore mutex = 1, w = 1;"/>

    <meta property="og:title" content="Blog_11_23_读者写者问题的三种写法" />
<meta property="og:description" content="====================================================================== readers are prior [analyse:] writer:
can&rsquo;t write when anyone is reading. exclusive
readers: when one of the readers are reading, the readers who want to read can read.
but them can&rsquo;t read when the writer is writing. exclusive
the action to change the readcount and the lock made the reader and writer exclusive are exclusive.
====================================================================== //the reason why the readcount is not a semaphore is that it was // a condition ,and not a semaphore make the process exclusive int readcount = 0; semaphore mutex = 1, w = 1;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lostlese.github.io/post/blog_11_23/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-11-23T16:24:43+08:00" />
<meta property="article:modified_time" content="2022-11-23T16:24:43+08:00" />


    <style type="text/css">
        .li1{
          list-style-type: none;
          text-decoration: none;
          margin: 0;
        }
	   li{
		list-style-type: none;
		}	
        .p1{
          font-size: 10px;
        }
        .app-header-title{
          font-size: 15px;
        }
    </style>

  </head>
  <body>


    <header class="app-header">
      <a href="https://lostlese.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="Yongqiang" /></a>
      <span class="app-header-title">The Blog of Yongqiang</span>
      <p class="p1">Yongqiang , a tired man who want a job of Microsoft, are fighting for his future. </p>
	<ol>
		<li><span>QQ:</span>2058702513</li>
		<li><span>email:</span>2058702513@qq.com</li>
	</ol>
      <ol>
        <li class="li1"><a href="https://github.com/lostLese?tab=repositories">To the Github</a></li>
        <li class="li1"><a href="https://blog.csdn.net/qq_49507440?spm=1030.2200.3001.5343">To the CSDN</a></li>
        <li class="li1" ><input id="openBtn" type="button" value="My resume"></li>
      </ol>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Blog_11_23_读者写者问题的三种写法</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Nov 23, 2022
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>======================================================================
readers are prior
[analyse:]
writer:</p>
<p>can&rsquo;t write when anyone is reading. exclusive</p>
<p>readers:
when one of the readers are reading, the readers who want to read can
read.</p>
<p>but them can&rsquo;t read when the writer is writing. exclusive</p>
<p>the action to change the readcount and the lock made the reader and
writer exclusive are exclusive.</p>
<p>======================================================================
//the reason why the readcount is not a semaphore is that it was
// a condition ,and not a semaphore make the process exclusive
int readcount = 0; 			
semaphore mutex = 1, w = 1;</p>
<p>reader(){
while(1){
wait(mutex);
if(readcount == 0)
wait(w);		\读者读的时候互斥
readcount++;
signal(mutex);
读；
wait(mutex);
readcount&ndash;;
if(readcount == 0)
signal(w);
signal(mutex);
}
}</p>
<p>writer(){
while(1){
wait(w);
写；
siganl(w);
}
}</p>
<p>======================================================================
the writer is prior
[analyse:]
writer:
writer is one can write, but them have a list to block.
if there is a writer who is writing, others can push into the list
and wait for invoke.
else
they should be blocked by the lock
reader:
many and need read at seem time
but them can&rsquo;t read when the writer is writing. exclusive</p>
<p>======================================================================
siganl 和 wait() 本身就是原子性的。</p>
<p>int readcount = 0;
int writecount = 0;
semaphore w = 1, r = 1, mutex1 = 1, mutex2 = 1, mutex3 =1;</p>
<p>reader(){
while(1){
wait(metux3);
wait(r);	//互斥r的
wait(metux1);
if(readcount == 0)
wait(w);		//我们还没读完，你们可以进来但是你别写啊！
readcount++;
signal(mutex1);
signal(r);
读；
wait(mutex1);
readcount&ndash;;
if(readcount == 0)
signal(w);
signal(mutex1);
signal(metux3);	
}
}</p>
<p>writer(){
while(1){
wait(mutex2)；
if(writecount == 0)
wait(r);
writecount ++;
signal(mutex2);
wait(w);	//我们还没读完，你们可以进来但是你别写啊！
写；
signal(w);
wait(mutex2);
writecount&ndash;;
if(writecount == 0)
signal(r);
signal(mutex2);</p>
<pre><code>}
</code></pre>
<p>}</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
    <script>
      var openBtn = document.getElementById("openBtn");
      var newWindow;
      openBtn.onclick = function(){
        
        newWindow = open("https://raw.githubusercontent.com/lostLese/PicGo/master/img/简历_陆勇强_00.png");
      }
    </script>
  </body>
</html>
